<div id="menu_backlog_wrapper">
	<div class="display_menu">

		<!-- 閉じるボタン -->
		<div class='menu_item menu_close' style='position: absolute; width:160px; height:100px; top: 604px; left: 16px;'>
		<a title="ゲームに戻る" href="javascript:void(0)"><img src="data/others/plugin/theme_kopanda_22_HD_anim/image/system/btn_back.png"></a>
		</div>

		<!-- スクロールボタン タッチデバイス用 -->
		<img class="button_smart button_arrow_up"   src='data/others/plugin/theme_kopanda_22_HD_anim/image/system/arrow_up.png'   style='cursor:pointer;left: 92px; top: 234px; position: absolute;'>
		<img class="button_smart button_arrow_down" src='data/others/plugin/theme_kopanda_22_HD_anim/image/system/arrow_down.png' style='cursor:pointer;left: 92px; top: 450px; position: absolute;'>
		<div style="clear:both"></div>

		<!-- ログ本体 -->
		<div class="log_body" id="touchbox"></div>

	</div>

		<!-- 背景画像 -->
		<img class="img_bg_base" src="data/others/plugin/theme_kopanda_22_HD_anim/image/system/menu_log_bg.jpg" style='z-index:-1;left:0;top:0;width:100%;height:100%;position:absolute;'>
		<img class="img_label img_label_backlog" src="data/others/plugin/theme_kopanda_22_HD_anim/image/system/label_log.png" style='left:0;top:-10px;width:422px;height:158px;position:absolute;'>

		<!-- ボタンホバー時に画像を変更する -->
		<script>

			// 1.閉じるボタンのマウスダウン時に画像を変更
			// 2.タッチデバイス使用時、タップしたときに画像を変更
			// 不要な場合は下記をコメントアウト、デフォルトのコードのコメントアウトを解除してください

			$("#menu_backlog_wrapper .menu_item img").each((i, elm) => {
				const j_elm = $(elm);
				const original_src = j_elm.attr("src");
				const hover_src = original_src.replace(".png", "_hov.png");
				const click_src = original_src.replace(".png", "_clk.png");

				// ホバー時
				j_elm.hover(
					() => {
						j_elm.attr("src", hover_src);
					},
					() => {
						j_elm.attr("src", original_src);
					}
				);

				// タッチデバイス
				j_elm.on("touchstart", () => {
					j_elm.attr("src", hover_src);
				});
				j_elm.on("touchend touchcancel", () => {
					j_elm.attr("src", original_src);
				});

				// 押下イベント
				if (j_elm.closest(".menu_close").length > 0) {
					// 押したとき
					j_elm.on("mousedown", () => {
						j_elm.attr("src", click_src);
					});

					// 離したとき（ホバー中ならホバー、離れたら元に戻す）
					$(document).on("mouseup", () => {
						if (j_elm.is(":hover")) {
							j_elm.attr("src", hover_src);
						} else {
							j_elm.attr("src", original_src);
						}
					});

					// 押したままカーソルが外れたら元に戻す
					j_elm.on("mouseleave", (e) => {
						if (e.buttons === 1) {
							j_elm.attr("src", original_src);
						}
					});
				}
			});

		</script>

		<!-- スワイプ処理 -->
		<script>
			$(function(){
			var box = $('#touchbox')[0];
			var touchStartPositionX;
			var touchStartPositionY;
			var touchMovePositionX;
			var touchMovePositionY;
			var moveFarX;
			var moveFarY;
			var startScrollX;
			var startScrollY;
			var moveScrollX;
			var moveScrollY;

			box.addEventListener("touchstart",touchHandler,false);
			box.addEventListener("touchmove",touchHandler,false);

			function touchHandler(e){
				var touch = e.touches[0];
				if(e.type == "touchstart"){
					touchStartPositionX = touch.pageX;
					touchStartPositionY = touch.pageY;

					//タッチ前スクロールをとる
					startScrollX = $('#touchbox').scrollLeft();
					startScrollY = $('#touchbox').scrollTop();
				}
				if(e.type == "touchmove"){
					e.preventDefault();

					//現在の座標を取得
					touchMovePositionX = touch.pageX;
					touchMovePositionY = touch.pageY;

					//差をとる
					moveFarX = touchStartPositionX - touchMovePositionX;
					moveFarY = touchStartPositionY - touchMovePositionY;

					//スクロールを動かす
					moveScrollX = startScrollX +moveFarX;
					moveScrollY = startScrollY +moveFarY;
					$('#touchbox').scrollLeft(moveScrollX);
					$('#touchbox').scrollTop(moveScrollY);
				}
			}
		});

		</script>

</div>
